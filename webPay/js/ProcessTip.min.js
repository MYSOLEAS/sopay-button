let params,origin;window.onload=function(){window.opener.postMessage("isReady","*")},window.addEventListener("message",a=>{a.origin!==window.location.origin&&(params=a.data),origin=a.origin,$("#detail_amount").html(`${params.currency}`),$("#detail_description").html(`${params.description}`)},!1);function tip({elem:a,successUrl:b,currency:c,description:d,businessName:e,ref:f,apiKey:g}){const h=$(`${a}_amount`).val(),i=$(`${a}_wallet`).val(),j=$(`${a}_service`).val(),k=$("#payer_name").val(),l=$(`${a}_otp`).val(),m="https://soleaspay.com/api/agent/bills",n=a=>{if(a.success&&params.loadInvoice){const b={outputType:"save",returnJsPDFDocObject:!0,fileName:`Invoicing-${e}`,orientationLandscape:!1,logo:{src:"https://soleaspay.com/qr/pay/asset/sopay.png",width:43.33,height:26.66,margin:{top:0,left:0}},business:{name:e},contact:{label:"Invoice issued for:",name:k,otherInfo:"https://app.soleaspay.com"},invoice:{label:"Invoice #: ",num:a.data.payId,invDate:`Payment Date: ${new Date().toDateString()}`,headerBorder:!1,tableBodyBorder:!1,header:["Ref","Description","Price"],table:[[`${a.data.payId}`,`${d}`,h]],invTotalLabel:"Total:",invTotal:`${h}`,invCurrency:c},footer:{text:"SoleasPay Payment Gateway"},pageEnable:!1};jsPDFInvoiceTemplate.default(b)}handleSendResponse(a),setTimeout(()=>window.close(),5e3)};switch(a){case"#om":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${g}`,operation:"2",service:`${j}`,otp:`${l}`},data:JSON.stringify({amount:h,wallet:i,currency:c,description:d,payer:k,ref:f})}).done(function(a){n(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#momo":$("#loader").show(),$.alert({title:lang.momo.title,content:lang.momo.content}),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${g}`,operation:"2",service:`${j}`,otp:`${l}`},data:JSON.stringify({amount:h,wallet:i,currency:c,description:d,payer:k,ref:f})}).done(function(a){n(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#eu":$("#loader").show(),$.alert({title:lang.eu.title,content:lang.eu.content}),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${g}`,operation:"2",service:`${j}`,otp:`${l}`},data:JSON.stringify({amount:h,wallet:i,currency:c,description:d,payer:k,ref:f})}).done(function(a){n(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#bitcoin":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${g}`,operation:"2",service:`${j}`},data:JSON.stringify({amount:h,currency:c,description:d,payer:k,ref:f})}).done(function(a){a.success&&$.alert({title:lang.bitcoin.title,content:`${lang.bitcoin.title}. <br>
                                    
                                    <div class="alert alert-secondary" role="alert">
                                    <div id="qrcode"></div>
                                    <input type="text" value="${a.data.wallet}" disabled id="myInput">
                                        <input type="button" value="Copy wallet" class="btn btn-default" onclick="copyToClipboard(); this.value='Copied!'">
                                    </div>
                                       <br> ${lang.bitcoin.total} : <b>${a.data.value} ${a.data.currency}</b>`}),handleSendResponse(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#paypal":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${g}`,operation:"2",service:`${j}`},data:JSON.stringify({amount:h,wallet:i,currency:c,description:d,payer:k,ref:f})}).done(function(a){a.success&&window.open(`${a.data.payLink}`,"newwindow","width=900, height=800"),handleSendResponse(a),setTimeout(()=>window.close(),5e3)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#pm":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${g}`,operation:"2",service:`${j}`},data:JSON.stringify({amount:h,currency:c,description:d,payer:k,ref:f})}).done(function(a){a.success&&window.open(`https://soleaspay.com/pm/pay.html?amount=${h}&ref=${a.data.payId}&currency=${c}&successUrl=${b}`,"newwindow","width=900, height=800"),handleSendResponse(a),setTimeout(()=>window.close(),5e3)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;default:}}$("#om_form").submit(function(a){a.preventDefault(),params.elem="#om",tip(params)}),$("#momo_form").submit(function(a){a.preventDefault(),params.elem="#momo",tip(params)}),$("#eu_form").submit(function(a){a.preventDefault(),params.elem="#eu",tip(params)}),$("#bitcoin_form").submit(function(a){a.preventDefault(),params.elem="#bitcoin",tip(params)}),$("#pm_form").submit(function(a){a.preventDefault(),params.elem="#pm",tip(params)}),$("#paypal_form").submit(function(a){a.preventDefault(),params.elem="#paypal",tip(params)}),$("#detail_amount").html(`${params.currency}`),$("#detail_description").html(`${params.description}`);function copyToClipboard(){var a=document.getElementById("myInput");a.select(),a.setSelectionRange(0,99999),navigator.clipboard.writeText(a.value)}function handleSendResponse(a){window.opener.postMessage(a,origin)}