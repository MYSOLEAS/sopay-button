let params,origin;window.onload=function(){window.opener.postMessage("isReady","*")},window.addEventListener("message",a=>{a.origin!==window.location.origin&&(params=a.data),origin=a.origin,$("#detail_amount").html(`${params.amount} ${params.currency}`),$("#detail_description").html(`${params.description}`)},!1);function bill({elem:a,amount:b,successUrl:c,currency:d,description:e,businessName:f,ref:g,apiKey:h}){const i=$(`${a}_wallet`).val(),j=$(`${a}_service`).val(),k=$(`${a}_otp`).val(),l=$("#payer_name").val(),m="https://soleaspay.com/api/agent/sandbox",n=a=>{if(a.success){const c={outputType:"save",returnJsPDFDocObject:!0,fileName:`Invoicing-${f}`,orientationLandscape:!1,logo:{src:"https://soleaspay.com/qr/pay/asset/sopay.png",width:43.33,height:26.66,margin:{top:0,left:0}},business:{name:f},contact:{label:"Invoice issued for:",name:l,otherInfo:"https://app.soleaspay.com"},invoice:{label:"Invoice #: ",num:a.data.payId,invDate:`Payment Date: ${new Date().toDateString()}`,headerBorder:!1,tableBodyBorder:!1,header:["Ref","Description","Price"],table:[[`${a.data.payId}`,`${e}`,b]],invTotalLabel:"Total:",invTotal:`${b}`,invCurrency:d},footer:{text:"SoleasPay Payment Gateway"},pageEnable:!1};jsPDFInvoiceTemplate.default(c)}handleSendResponse(a),setTimeout(()=>window.close(),5e3)};switch(a){case"#om":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${h}`,operation:"2",service:`${j}`,otp:`${k}`},data:JSON.stringify({amount:b,wallet:i,currency:d,description:e,payer:l,ref:g})}).done(function(a){n(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#momo":$("#loader").show(),$.alert({title:lang.momo.title,content:lang.momo.content}),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${h}`,operation:"2",service:`${j}`,otp:`${k}`},data:JSON.stringify({amount:b,wallet:i,currency:d,description:e,payer:l,ref:g})}).done(function(a){n(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#eu":$("#loader").show(),$.alert({title:lang.eu.title,content:lang.eu.content}),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${h}`,operation:"2",service:`${j}`,otp:`${k}`},data:JSON.stringify({amount:b,wallet:i,currency:d,description:e,payer:l,ref:g})}).done(function(a){n(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#bitcoin":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${h}`,operation:"2",service:`${j}`},data:JSON.stringify({amount:b,currency:d,description:e,payer:l,ref:g})}).done(function(a){a.success&&$.alert({title:lang.bitcoin.title,content:`${lang.bitcoin.content}. <br>
                            
                            <div class="alert alert-secondary" role="alert">
                            <div id="qrcode"></div>
                            <input type="text" value="${a.data.wallet}" disabled id="myInput">
                                <input type="button" value="Copy wallet" class="btn btn-default" onclick="copyToClipboard(); this.value='Copied!'">
                            </div>
                               <br> ${lang.bitcoin.total} : <b>${a.data.value} ${a.data.currency}</b>`}),handleSendResponse(a)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#paypal":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${h}`,operation:"2",service:`${j}`},data:JSON.stringify({amount:b,wallet:i,currency:d,payer:l,ref:g})}).done(function(a){a.success&&window.open(`${a.data.payLink}`,"newwindow","width=900, height=800"),handleSendResponse(a),setTimeout(()=>window.close(),5e3)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;case"#pm":$("#loader").show(),$.ajax({type:"POST",beforeSend:function(){},url:m,dataType:"JSON",headers:{"Content-Type":"application/json","x-api-key":`${h}`,operation:"2",service:`${j}`},data:JSON.stringify({amount:b,currency:d,payer:l,ref:g})}).done(function(a){a.success&&window.open(`https://soleaspay.com/pm/pay.html?amount=${b}&ref=${a.data.payId}&currency=${d}&successUrl=${c}`,"newwindow","width=900, height=800"),handleSendResponse(a),setTimeout(()=>window.close(),5e3)}).fail(a=>console.error(a)).always(function(){$("#loader").hide()});break;default:}}$("#om_form").submit(function(a){a.preventDefault(),params.elem="#om",bill(params)}),$("#momo_form").submit(function(a){a.preventDefault(),params.elem="#momo",bill(params)}),$("#eu_form").submit(function(a){a.preventDefault(),params.elem="#eu",bill(params)}),$("#bitcoin_form").submit(function(a){a.preventDefault(),params.elem="#bitcoin",bill(params)}),$("#pm_form").submit(function(a){a.preventDefault(),params.elem="#pm",bill(params)}),$("#paypal_form").submit(function(a){a.preventDefault(),params.elem="#paypal",bill(params)});function copyToClipboard(){var a=document.getElementById("myInput");a.select(),a.setSelectionRange(0,99999),navigator.clipboard.writeText(a.value)}function handleSendResponse(a){window.opener.postMessage(a,origin)}